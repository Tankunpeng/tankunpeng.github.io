<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Kunpeng's blog</title>
</head>
<body>
	<!--<a href="cv">简历</a>-->
	<!--<a href="fe/IFE/ife.html">IFE展示</a>-->
	<a href="arts/">ARTS 计划</a>
	<a href="gof/">设计模式</a>
	<div id="app-refresh">设计模式</div>
	
	<script>
	if ('serviceWorker' in navigator) {
	    window.addEventListener('load', function() {
		navigator.serviceWorker.register('/sw.js').then(function(registration) {
		    // Registration was successful
		    console.log('ServiceWorker registration successful with scope: ', registration.scope);
		}, function(err) {
		    // registration failed :(
		    console.log('ServiceWorker registration failed: ', err);
		});
	    });
	}	
		
		// 点击指定 DOM 时就给Service Worker 发送消息
		document.getElementById('app-refresh').addEventListener('click', function () {
			console.log('clicked')
		    navigator.serviceWorker.controller && navigator.serviceWorker.controller.postMessage({type: 'cache', data: [
    '/',
    '/gof/',
    '/arts/'
];});
		});
		
		// 接受 service worker 消息
		navigator.serviceWorker.addEventListener('message', function (event) {
		    if (e.data === 'sw.update') {
			// 此处可以操作页面的 DOM 元素啦
		    }
		});
    	</script>
</body>
</html>
